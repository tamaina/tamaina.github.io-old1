<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>webpackとWorkboxを使い始めた - アキウス</title><!--*
*
*
* THANK YOU FOR SEEING IT'S SOURCE!!
*
* Github: https://github.com/tamaina/tamaina.github.io
*
*
*
*
--><link rel="canonical" href="https://tmin.xyz/docs/blog/maqz001400/"><meta name="author" content="aqz"><meta name="generator" content="maqz"><meta name="description" content="Browserifyと自家製ServiceWorkerを置き換えました。"><link rel="icon" href="/docs/favicon.ico" type="image/vnd.microsoft.icon"><link rel="apple-touch-icon" href="/docs/files/images/icons/icon.svg" sizes="600x600"><link rel="icon" href="/docs/files/images/icons/icon.svg" sizes="600x600" type="image/svg+xml"><link rel="apple-touch-icon" href="/docs/files/images/icons/icon.png" sizes="600x600"><link rel="icon" href="/docs/files/images/icons/icon.png" sizes="600x600" type="image/png"><link rel="manifest" href="/docs/manifest.json"><link href="/docs/assets/style.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" crossorigin="anonymous"><link href="https://cdn.jsdelivr.net/npm/yakuhanjp/dist/css/yakuhanjp.min.css" rel="stylesheet" crossorigin="anonymous"><script src="/docs/assets/main.min.js" defer></script><script src="/docs/assets/fab.js" defer></script><script src="/docs/assets/pjax-api.min.js" defer></script><script src="/docs/assets/pjax-init.js" defer></script><script class='pjax-reload'>
  var disqus_config = function () {
    this.page.url = "https://tmin.xyz/docs/blog/maqz001400/";
    this.page.identifier = "tmin.xyz/docs/blog/maqz001400/";
  };
 // twbs/bootstrap build/sw.jsより借用
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('https://tmin.xyz/docs/service_worker.js').then(function(registration) {
      console.log('Service Workerは正常に登録されました: ', registration.scope);
        registration.onupdatefound = function () {
        var installingWorker = registration.installing
        installingWorker.onstatechange = function () {
          switch (installingWorker.state) {
            case 'installed':
              if (navigator.serviceWorker.controller) {
                console.log('ページの更新があります……')
                location.reload(true)
              }
              break
            default:
          }
        }
      }
    }).catch(function(err) {
      console.log('Service Workerを登録できませんでした: ', err);
    });
  }
// twbs/bootstrap build/sw.jsより借用
</script><meta name="theme-color" content="#2d88ef"><link rel="manifest" href="/docs/manifest.json"><link rel="alternate" href="https://github.com/tamaina/tamaina.github.io/commits/master.atom" type="application/atom+xml" title="アキウス"><meta property="og:type" content="website"><meta property="og:title" content="webpackとWorkboxを使い始めた - アキウス"><meta property="og:description" content="Browserifyと自家製ServiceWorkerを置き換えました。"><meta property="og:image" content="https://tmin.xyz/docs/files/images/icons/icon.png"><meta property="og:url" content="https://tmin.xyz/docs/blog/maqz001400/"><meta property="og:site_name" content="アキウス"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://tmin.xyz/docs/files/images/icons/icon.png"><meta name="twitter:title" content="webpackとWorkboxを使い始めた - アキウス"><meta name="twitter:description" content="Browserifyと自家製ServiceWorkerを置き換えました。"><meta name="twitter:site" content="aqzti"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-107753466-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-107753466-1');
</script>
</head><body><nav class="navbar navbar-dark bg-dark flex-row p-1" id="mainnav"><a class="navbar-brand" href="/docs/" id="navbar_brand"><img class="d-inline-block align-top" src="/docs/files/images/icons/icon.svg" width="30" height="30" alt="ICON"><div class="navbar-brand-text">tmin.xyz</div></a><div id="navbar_items"><div class="navbar-nav flex-row justify-content-center"><a class="text-light nav-item nav-link px-3" href="/docs/maqz/">maqz</a><a class="text-light nav-item nav-link px-3" href="/docs/blog/">ブログ</a><a class="text-light nav-item nav-link px-3" href="https://chirno.tmin.xyz/" target="_blank" rel="noopener">Chirno<i class="fa fa-external-link fa-fw" aria-hidden="true"></i></a><a class="text-light nav-item nav-link px-3" href="http://tmin.xyz/The-Japanese-Web-Fonts/#!index.md" target="_blank" rel="noopener">🇯🇵WebFont<i class="fa fa-external-link fa-fw" aria-hidden="true"></i></a></div></div></nav><nav class="bg-primary sticky-top" aria-label="breadcrumb" id="breadcrumb"><div class="container-fulid px-1 px-lg-5"><ol class="breadcrumb bg-primary text-white my-0 mx-md-5 mx-1 py-1"><li class="breadcrumb-item"><a class="py-1" href="/docs/">Home</a></li><li class="breadcrumb-item"><a class="py-1 text-white" href="/docs/blog/">ブログ</a></li><li class="breadcrumb-item text-white font-weight-bold" aria-current="page">webpackとWorkboxを使い始めた</li></ol></div></nav><div class="pb-5 pt-0" id="main"><article><header class="text-light" id="main_header" style="background-color: #212121;"><div class="container"><h1 id="blogheader_top">webpackとWorkboxを使い始めた</h1><div class="mb-1"><ul class="list-unstyled"><li><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i><time datetime="2017-11-02T06:43:23.599Z">2017年11月2日 15:43</time> 作成</li><li><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i><time datetime="2017-11-20T09:32:30.068Z">2017年11月20日 18:32</time> 更新</li></ul></div><div class="mb-3"><i class="fa fa-folder-open fa-fw" aria-hidden="true"></i><a class="badge badge-success" href="/docs/blog/category/web/">web</a> &emsp;<i class="fa fa-tags fa-fw" aria-hidden="true"></i><span class="badge badge-info">maqz</span> </div><div class="mb-3" id="blogheader_description">Browserifyと自家製ServiceWorkerを置き換えました。</div></div><div class="d-flex flex-wrap" id="blogheader_footer"><a class="py-3 text-light" href="/docs/blog/getval_test/" id="blogheader_prev"><div class="container">前: Markdown代入テスト</div></a><a class="py-3 text-light" href="/docs/blog/about_me/" id="blogheader_next"><div class="container">次: 私について</div></a></div></header><div class="container pt-3"><p>ちゃんと&quot;近代化&quot;を施しました。</p><p>タスクツールのGruntは永遠に変わらない気がしますが……</p><h2 class="pt-5" id="browserify-%E2%86%92-webpack">Browserify → webpack</h2><p>とりあえずwebpackは纏めるだけです。</p><p>やっぱり速いですね。</p><p>pugを改良し、highlight.jsをビルド時にパースするようにしました。クライアントサイドJSのサイズ・読み込みのさらなる軽量化が期待できます。</p><p>highlight.jsの処理部は<code>_script.pug</code>、webpackの処理部は<code>Gruntfile.js</code>および<code>webpack.config.js</code>です。</p><h2 class="pt-5" id="workbox">Workbox</h2><p>自分で作ったServiceWorkerを使ってブラウザにキャッシュさせていましたが、正直あまりうまくいきませんでした。</p><p>Workboxは、そんな面倒くさいServiceWorkerキャッシュを簡略化してくれるライブラリです。</p><p>日本語の情報が少なくて、Bootstrapのプロジェクトを見るまで知りませんでした。</p><p>Workboxのビルド時の処理は、<strong>twbs/bootstrapのv4-devブランチからコードを借用しました。</strong><br>若干の変更はありますが、ほぼ全てをbuild/service-worker.jsから引用しました。</p><p>ビルド処理部は<code>Gruntfile.js</code>の<code>sw</code>タスクです。<code>workboxer()</code>関数が指定されています。<br>クライアント処理部はそのコードを見ればどうなってるかわかると思います。<br>bootstrapのビルドスクリプトはどちゃくそ有能なのでぜひ使ってみて……</p></div></article></div><div class="container py-5"><div id="disqus_wrap"><div id="disqus_thread"></div></div></div><div class="py-3 bg-light" id="footer_wrap"><footer class="container"><p>Copyright: tamaina</p><p class="m-0">This site built by maqz</p></footer></div><div id="share_modal_open_button"><button class="btn btn-primary rounded-circle ml-lg-5 m-3" type="button" data-toggle="modal" data-target="#share_modal" aria-labelledby="share_modal_label"><i class="fa fa-share-square-o fa-fw" aria-hidden="true"></i></button></div><div class="modal fade" id="share_modal" tabindex="-1" role="dialog" aria-labelledby="share_modal_label" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"><i class="fa fa-share-square-o fa-fw" aria-hidden="true"></i>シェア</h5><button class="close" type="button" data-dismiss="modal" aria-label="閉じる"><span aria-hidden="true">&times;</span></button></div><div class="modal-body" id="share_modal_body"><p id="share_modal_label">「webpackとWorkboxを使い始めた」をSNSで共有</p><a class="twitter-share-button" href="https://twitter.com/share?ref_src=twsrc%5Etfw" data-show-count="true">Tweet</a> <a class="twitter-follow-button" href="https://twitter.com/aqzti?ref_src=twsrc%5Etfw" data-show-count="false">Follow @aqzti</a> <br><div class="line-it-button" style="display: none;" data-lang="ja" data-type="share-a" data-url="https://tmin.xyz/docs/blog/maqz001400/"></div><br><div class="fb-share-button" data-href="https://tmin.xyz/docs/blog/maqz001400/" data-layout="button_count" data-size="small" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftmin.xyz%2Fdocs%2Fblog%2Fmaqz001400%2F">シェア</a></div></div></div></div></div><div id="fb-root"></div><script src='https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.11&appId=1216117028459212' id='facebook-jssdk'></script>
<script src='https://platform.twitter.com/widgets.js'></script>
<script src='https://d.line-scdn.net/r/web/social-plugin/js/thirdparty/loader.min.js'></script><!--WE'RE SUPER CREW
--><script>(function() {var d = document, s = d.createElement('script');s.src = 'https://tminxyz.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s);})();</script></body></html>